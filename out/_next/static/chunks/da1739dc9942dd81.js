(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67892,e=>{"use strict";var t=e.i(87433),l=e.i(44440),s=e.i(32694),o=e.i(47163);let r=["oklch(0.75 0.12 220)","oklch(0.82 0.1 340)","oklch(0.85 0.08 80)","oklch(0.7 0.1 180)","oklch(0.78 0.12 300)","oklch(0.8 0.1 140)","oklch(0.75 0.15 20)","oklch(0.82 0.08 260)"],n=["吃火锅","看电影","逛街","在家宅"];function i(){let[e,i]=(0,l.useState)(n),[a,d]=(0,l.useState)(""),[c,h]=(0,l.useState)(!1),[x,u]=(0,l.useState)(null),[m,f]=(0,l.useState)(0),[g,p]=(0,l.useState)(!1),b=(0,l.useRef)(null),{addHistory:y,history:v,pendingPreset:j,clearPendingPreset:k}=(0,s.useHistory)();(0,l.useEffect)(()=>{j&&j.length>=2&&(i(j),u(null),k())},[j,k]);let w=v.filter(e=>"wheel"===e.type&&e.options&&e.options.length>=2).reduce((e,t)=>{let l=[...t.options||[]].sort().join("|");return e.some(e=>e.key===l)||e.push({options:t.options,key:l,lastUsed:t.timestamp}),e},[]).slice(0,5),N=(0,l.useCallback)(()=>{let t=b.current;if(!t||0===e.length)return;let l=t.getContext("2d");if(!l)return;let s=window.devicePixelRatio||1;t.width=280*s,t.height=280*s,t.style.width="280px",t.style.height="280px",l.scale(s,s);let o=2*Math.PI/e.length;l.clearRect(0,0,280,280),l.save(),l.shadowColor="rgba(0,0,0,0.15)",l.shadowBlur=20,l.shadowOffsetY=4,l.beginPath(),l.arc(140,140,132,0,2*Math.PI),l.fillStyle="#fff",l.fill(),l.restore(),e.forEach((t,s)=>{let n=s*o-Math.PI/2;l.beginPath(),l.moveTo(140,140),l.arc(140,140,132,n,n+o),l.closePath(),l.fillStyle=r[s%r.length],l.fill(),l.strokeStyle="rgba(255,255,255,0.6)",l.lineWidth=2,l.stroke(),l.save(),l.translate(140,140),l.rotate(n+o/2),l.textAlign="center",l.textBaseline="middle",l.fillStyle="#fff",l.font=`bold ${Math.min(16,140/e.length)}px Nunito, sans-serif`,l.shadowColor="rgba(0,0,0,0.3)",l.shadowBlur=4;let i=t.length>6?t.slice(0,5)+"..":t;l.fillText(i,79.2,0),l.restore()}),l.beginPath(),l.arc(140,140,20,0,2*Math.PI),l.fillStyle="#fff",l.fill(),l.strokeStyle="oklch(0.72 0.12 220)",l.lineWidth=3,l.stroke(),l.save(),l.translate(140,140),l.scale(.6,.6),l.beginPath(),l.moveTo(0,-5),l.bezierCurveTo(-10,-18,-22,-5,0,12),l.moveTo(0,-5),l.bezierCurveTo(10,-18,22,-5,0,12),l.fillStyle="oklch(0.82 0.1 340)",l.fill(),l.restore()},[e]);(0,l.useEffect)(()=>{N()},[N]);let C=(0,l.useCallback)(()=>{if(c||e.length<2)return;h(!0),u(null);let t=Math.floor(Math.random()*e.length),l=360/e.length,s=(360-t*l-l/2)%360,o=(m%360+360)%360,r=(s-o+360)%360,n=5+Math.floor(5*Math.random()),i=m+360*n+r;console.log("Wheel spin calculation:",{targetIndex:t,sliceAngle:l,targetAngle:s,currentAngle:o,needed:r,extraRotations:n,finalRotation:i%360,optionsCount:e.length,options:e}),f(i),setTimeout(()=>{h(!1);let l=e[t];u(l),y({type:"wheel",question:`选项: ${e.join(", ")}`,result:l,options:[...e]})},4e3)},[c,e,m,y]),P=(0,l.useCallback)(()=>{let t=a.trim();t&&e.length<8&&(i(e=>[...e,t]),d(""))},[a,e.length]),S=(0,l.useCallback)(e=>{i(t=>t.filter((t,l)=>l!==e))},[]),T=(0,l.useCallback)(e=>{i(e),u(null),p(!1)},[]);return(0,t.jsxs)("div",{className:"flex flex-col items-center px-4 pt-6 pb-4",children:[(0,t.jsxs)("div",{className:"mb-4 text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-extrabold text-foreground",children:"幸运转盘"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-medium text-muted-foreground",children:"添加选项，转动转盘，让命运来决定~"})]}),(0,t.jsxs)("div",{className:"relative mb-6",children:[(0,t.jsx)("div",{className:"absolute -top-2 left-1/2 z-20 -translate-x-1/2",children:(0,t.jsx)("svg",{width:"28",height:"32",viewBox:"0 0 28 32",children:(0,t.jsx)("polygon",{points:"14,32 0,12 14,0 28,12",fill:"oklch(0.82 0.1 340)",stroke:"#fff",strokeWidth:"2"})})}),(0,t.jsx)("div",{style:{transform:`rotate(${m}deg)`,transitionDuration:c?"4s":"0s",transitionTimingFunction:"cubic-bezier(0.17, 0.67, 0.12, 0.99)",transitionProperty:"transform"},children:(0,t.jsx)("canvas",{ref:b,className:"h-[280px] w-[280px]"})})]}),x&&(0,t.jsxs)("div",{className:"mb-4 animate-bounce-soft rounded-2xl bg-card px-6 py-3 text-center shadow-md ring-1 ring-border",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-muted-foreground",children:"结果是"}),(0,t.jsx)("p",{className:"text-xl font-extrabold text-primary",children:x})]}),(0,t.jsx)("button",{onClick:C,disabled:c||e.length<2,className:(0,o.cn)("mb-6 rounded-2xl px-10 py-3.5 text-lg font-bold shadow-lg transition-all duration-300","bg-primary text-primary-foreground","hover:shadow-xl hover:scale-105 active:scale-95","disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",c&&"animate-pulse-glow"),children:c?"转动中...":"开始转动"}),(0,t.jsxs)("div",{className:"w-full max-w-sm rounded-2xl border border-border bg-card p-4 shadow-sm",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-base font-bold text-foreground",children:"选项列表"}),w.length>0&&(0,t.jsxs)("button",{onClick:()=>p(!g),className:(0,o.cn)("flex items-center gap-1 rounded-xl px-3 py-1 text-xs font-bold transition-all hover:scale-105 active:scale-95",g?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:[(0,t.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("polyline",{points:"12,6 12,12 16,14"})]}),"历史选项"]})]}),g&&w.length>0&&(0,t.jsxs)("div",{className:"mb-3 rounded-xl border border-border bg-muted/50 p-3",children:[(0,t.jsx)("p",{className:"mb-2 text-xs font-semibold text-muted-foreground",children:"点击即可加载之前用过的选项:"}),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:w.map(e=>(0,t.jsxs)("button",{onClick:()=>T(e.options),className:"flex items-center gap-2 rounded-xl bg-card p-2.5 text-left shadow-sm ring-1 ring-border transition-all hover:scale-[1.02] hover:ring-primary/30 active:scale-[0.98]",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-primary/10",children:(0,t.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"text-primary",children:[(0,t.jsx)("polyline",{points:"9 11 12 14 22 4"}),(0,t.jsx)("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"truncate text-sm font-semibold text-foreground",children:e.options.join("、")}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:`${e.options.length} 个选项`})]})]},e.key))})]}),(0,t.jsxs)("div",{className:"mb-3 flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:a,onChange:e=>d(e.target.value),onKeyDown:e=>"Enter"===e.key&&P(),placeholder:"输入新选项...",maxLength:20,className:"flex-1 rounded-xl border border-input bg-background px-3 py-2 text-sm font-medium text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"}),(0,t.jsx)("button",{onClick:P,disabled:!a.trim()||e.length>=8,className:"rounded-xl bg-primary px-4 py-2 text-sm font-bold text-primary-foreground transition-all hover:scale-105 active:scale-95 disabled:opacity-50 disabled:hover:scale-100",children:"添加"})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map((e,l)=>(0,t.jsxs)("div",{className:"group flex items-center gap-1.5 rounded-xl px-3 py-1.5 text-sm font-semibold text-primary-foreground shadow-sm transition-all hover:scale-105",style:{backgroundColor:r[l%r.length]},children:[(0,t.jsx)("span",{children:e}),(0,t.jsx)("button",{onClick:()=>S(l),className:"ml-0.5 flex h-4 w-4 items-center justify-center rounded-full bg-primary-foreground/20 text-xs text-primary-foreground opacity-60 transition-opacity hover:opacity-100","aria-label":`删除${e}`,children:(0,t.jsxs)("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[(0,t.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,t.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},`${e}-${l}`))}),e.length<2&&(0,t.jsx)("p",{className:"mt-2 text-xs font-medium text-destructive",children:"至少需要添加 2 个选项才能转动哦~"})]})]})}e.s(["WheelPage",()=>i])}]);